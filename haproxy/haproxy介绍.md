<br>

## 什么是haproxy

haproxy是一个专业做L4、L7层负载均衡的服务，相较于nginx性能更好。



<br>



## haproxy核心功能

- `负载均衡`：L4和L7两种模式，支持多种负载均衡算法；
- `健康检查`：支持TCP和HTTP两种健康检查模式；
- `会话保持`：对于未实现会话共享的应用集群，可通过多种Hash方式实现会话保持；
- `SSL`：HAProxy可以解析HTTPS协议，并能够将请求解密为HTTP后向后端传输；
- HTTP请求重写与重定向；
- `监控与统计`：HAProxy提供了基于Web的统计信息页面，展现健康状态和流量数据。基于此功能，使用者可以开发监控程序来监控HAProxy的状态；



<br>



## haproxy特性

### **性能**

- 采用单线程、事件驱动、非阻塞模型，减少上下文切换的消耗，能在1ms内处理数百个请求。并且每个会话只占用数KB的内存。
- 大量精细的性能优化，如O(1)复杂度的事件检查器、延迟更新技术、Single-buffereing、Zero-copy forwarding等等，这些技术使得HAProxy在中等负载下只占用极低的CPU资源。
- HAProxy大量利用操作系统本身的功能特性，使得其在处理请求时能发挥极高的性能，通常情况下，HAProxy自身只占用15%的处理时间，剩余的85%都是在系统内核层完成的。
- 单个HAProxy进程的处理能力突破了10万请求/秒，并轻松占满了10Gbps的网络带宽。



### **稳定性**

HAProxy从未出现过一个会导致其崩溃的BUG，HAProxy一旦成功启动，除非操作系统或硬件故障，否则几乎不会崩溃。

在上文中提到过，HAProxy的大部分工作都是在操作系统内核完成的，所以HAProxy的稳定性主要依赖于操作系统，作者建议使用2.6或3.x的Linux内核，对sysctls参数进行精细的优化，并且确保主机有足够的内存。这样HAProxy就能够持续满负载稳定运行数年之久。

<br>

## 支持的算法

- roundrobin（RR）
- static-rr
- leastconn